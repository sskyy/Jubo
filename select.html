<!DOCTYPE html>
<html>
	<head>
	<meta charset="utf8">
    <script src="./lib/snap.svg-min.js"></script>
    <script src="./lib/jquery-1.10.2.min.js"></script>
    <script src="./lib/underscore-min.js"></script>
    <script src="./lib/head.core.min.js"></script>
    <script src="./lib/moment-with-langs.js"></script>
    <script src="./lib/page.js"></script>
    <link href="./css/main.css" type="text/css" rel="stylesheet"/>
</head>
<body>

    <div class="left"></div>
    <div class="right"  ms-controller="event">
        <div id="overview" ms-attr-class="(detailParam&&'shortcut')" ms-click='clearDetailParam'>
        	<div id="brief">
        		<div id="title"	>{{title}}</div>
        		<div id="intro">{{intro}}</div>
        	</div>

        	<div id="diagram" ms-if="title">
        		<canvas id="diagramBg" width="1600" height="800"></canvas>
        		<svg id="metricLines">
     
                </svg>

 <!--                <svg id="brackets" class="brackets" ms-if="currentParam">
                    <path ms-if="currentParam.index!=0" ms-attr-d="'M'+((currentParam.index)*200-100)+' 550 Q'+((currentParam.index)*200-100)+' 560 '+((currentParam.index)*200-50)+' 560 T'+((currentParam.index)*200)+' 570 Q'+((currentParam.index)*200)+' 560 '+((currentParam.index)*200+50)+' 560 T'+((currentParam.index)*200+100)+' 550'" fill="none" stroke="#cccccc" ></path>
                    <path ms-if="!(currentParam.index==params.length-1)" ms-attr-d="'M'+((currentParam.index)*200+100)+' 550 Q'+((currentParam.index)*200+100)+' 560 '+((currentParam.index)*200+150)+' 560 T'+((currentParam.index)*200+200)+' 570 Q'+((currentParam.index)*200+200)+' 560 '+((currentParam.index)*200+250)+' 560 T'+((currentParam.index)*200+300)+' 550'" fill="none" stroke="#cccccc" ></path>              
                    
                    <line ms-if="currentParam.param&&currentParam.index!=0" ms-attr-x1="(currentParam.index+1)*200-300" ms-attr-x2="(currentParam.index+1)*200-300" 
                        ms-attr-y1="(1-(params[currentParam.index-1].metric[currentMetric]-metricBottom)/(metricTop-metricBottom))*domBottom" y2="550" stroke="#dddddd" style="stroke-width: 2px;"></line>
                    <line ms-attr-x1="(currentParam.index+1)*200-100" ms-attr-x2="(currentParam.index+1)*200-100" 
                        ms-attr-y1="(1-(currentParam.param.metric[currentMetric]-metricBottom)/(metricTop-metricBottom))*domBottom" y2="550" stroke="#dddddd" style="stroke-width: 2px;"></line>
                    <line ms-if="currentParam.param&&!(currentParam.index==params.length-1)" ms-attr-x1="(currentParam.index+1)*200+100" ms-attr-x2="(currentParam.index+1)*200+100" 
                        ms-attr-y1="(1-(params[currentParam.index+1].metric[currentMetric]-metricBottom)/(metricTop-metricBottom))*domBottom" y2="550" stroke="#dddddd" style="stroke-width: 2px;"></line>
                </svg> -->

        		<div id="dates" ms-each-param="params">
                    <div class="time" ms-attr-style="'left:'+($index*200+50)+'px;'">{{param.timeText}}</div>
        		    <div class="time fromLast" ms-attr-style="'left:'+($index*200-50)+'px;'" ms-if='param.fromLast'>{{param.fromLast}}</div>
    <!--     		    <div style="position:absolute;left:150px;top:0px;color:#aaa;width:100px;text-align:center">1个月</div>
        		    <div style="position:absolute;left:250px;top:0px;color:#999;width:100px;text-align:center">9月1日</div>
                    <div style="position:absolute;left:350px;top:0px;color:#aaa;width:100px;text-align:center">2个月</div>
                    <div style="position:absolute;left:450px;top:0px;color:#999;width:100px;text-align:center">11月1日</div> -->
        		</div>


                <div id="params" ms-each-param="params">
                    <div ms-attr-id="'param'+($index+1)" ms-data-param="param" class="param" ms-mouseenter="active" ms-mouseleave="unactive" ms-click='setDetailParam'>
                        <div class="cover" ms-class="show:param.cover" ><img ms-src="param.cover"/></div>
                        <div class="title">{{param.title}}</div>
                        <div class="text">{{param.content}}</div>
                        <div class="more">!</div>
                    </div>
                </div>
        	</div>
        </div>
        <div id="detailParam" ms-if="detailParam">
            {{detailParam.content}}
            <img ms-src="detailParam.cover"/>
        </div>
    </div>

    <script src="./lib/avalon.js"></script>
    <script>
    avalon.require(['../app/main'],function(app){
        app.run()
    })
    </script>
</body>
</html>