<!DOCTYPE html>
<html>
	<head>
	<meta charset="utf8">
    <script src="./lib/snap.svg-min.js"></script>
    <script src="./lib/jquery-1.10.2.min.js"></script>
    <script src="./lib/underscore-min.js"></script>
    <script src="./lib/head.core.min.js"></script>
    <script src="./lib/moment-with-langs.js"></script>
    <script src="./lib/page.js"></script>
    <script src="./lib/responsiveslides.js"></script>
    <link href="./css/main.css" type="text/css" rel="stylesheet"/>
    <link href="./css/responsiveslide.css" type="text/css" rel="stylesheet"/>
</head>
<body>

    <div class="left"></div>
    <div class="right" ms-controller="event">
        <div id="detailParam" ms-attr-class="(view=='detailParam'&&'detailParam')" ms-controller="detailParam">
            <div id="paramBody">
                <div id="paramAuthor">
                    <a href="/users/s27zLn" class="author name">
                      <div class="avatar">
                        <img alt="0" src="http://tp3.sinaimg.cn/1221788390/180/1289279591/0">
                      </div>
                      <br>
                        {{author.name}}
                    </a>      
                    <div class="about">
                      <p class="intro">{{author.signature}}</p>
                    </div>
                    <div class="sns">
                      <a href="http://site.douban.com/cctvjz/"><i class="icon-home"></i></a><a href="http://weibo.com/u/1221788390" target="_blank"><img alt="Weibo_48" src="http://assets2.jianshu.io/assets/weibo_48-ecf8fc75c0b7211b0ecad85ce23eb1fe.png"></a><a href="http://www.douban.com/people/23446096" target="_blank"><img alt="Douban_48" src="http://assets3.jianshu.io/assets/douban_48-be5d39195c94e54ddf7077ed2fa27901.png"></a>
                    </div>
                </div>
                <div id="paramTitle">{{title}}</div>
                <div id="paramPics" ms-if="view=='detailParam'">
                  <ul id="slider" class="rslides" ms-each-pic="pics" data-each-rendered="detailParamRendered">
                    <li>
                      <img ms-src="pic.addr" alt="">
                      <p class="caption">{{pic.des}}</p>
                    </li>
                  </ul>
                  <div class="picNav">
                    <span class="picIndex">{{currentPic+1}}</span>/<span class="picTotal">{{pics.length}}</span>
                    </div>
                </div>
                <div id="detailParamContent">{{content}}</div>
            </div>
        </div>
        <div id="newParam" ms-attr-class="(view=='newParam'&&'newParam')">
            <input type="text" id="newParamTitle" placeholder="标题">
            <div id="">创建相册</div>
            <div id="newParamContent">内容</div>
        </div>
        <div id="overview" ms-attr-class="(view!='overview'&&'shortcut')">
        	<div id="brief"  ms-click='gotoOverview'>
        		<div id="title">{{title}}</div>
        		<div id="intro">{{intro}}</div>
        	</div>
            <div ms-click='gotoParamAdd'>Create Param</div>

        	<div id="diagram" ms-if="title">
        		<canvas id="diagramBg" width="1600" height="800"></canvas>
        		<svg id="metricLines">
     
                </svg>

                <svg id="brackets" class="brackets" ms-if="currentParam">
                    <path ms-if="currentParam.index!=0" ms-attr-d="'M'+((currentParam.index)*200-100)+' 550 Q'+((currentParam.index)*200-100)+' 560 '+((currentParam.index)*200-50)+' 560 T'+((currentParam.index)*200)+' 570 Q'+((currentParam.index)*200)+' 560 '+((currentParam.index)*200+50)+' 560 T'+((currentParam.index)*200+100)+' 550'" fill="none" stroke="#cccccc" ></path>
                    <path ms-if="!(currentParam.index==params.length-1)" ms-attr-d="'M'+((currentParam.index)*200+100)+' 550 Q'+((currentParam.index)*200+100)+' 560 '+((currentParam.index)*200+150)+' 560 T'+((currentParam.index)*200+200)+' 570 Q'+((currentParam.index)*200+200)+' 560 '+((currentParam.index)*200+250)+' 560 T'+((currentParam.index)*200+300)+' 550'" fill="none" stroke="#cccccc" ></path>              
                    
<!--                     <line ms-if="currentParam.param&&currentParam.index!=0" ms-attr-x1="(currentParam.index+1)*200-300" ms-attr-x2="(currentParam.index+1)*200-300" 
                        ms-attr-y1="(1-(params[currentParam.index-1].metric[currentMetric]-metricBottom)/(metricTop-metricBottom))*domBottom" y2="550" stroke="#dddddd" style="stroke-width: 2px;"></line>
                    <line ms-attr-x1="(currentParam.index+1)*200-100" ms-attr-x2="(currentParam.index+1)*200-100" 
                        ms-attr-y1="(1-(currentParam.param.metric[currentMetric]-metricBottom)/(metricTop-metricBottom))*domBottom" y2="550" stroke="#dddddd" style="stroke-width: 2px;"></line>
                    <line ms-if="currentParam.param&&!(currentParam.index==params.length-1)" ms-attr-x1="(currentParam.index+1)*200+100" ms-attr-x2="(currentParam.index+1)*200+100" 
                        ms-attr-y1="(1-(params[currentParam.index+1].metric[currentMetric]-metricBottom)/(metricTop-metricBottom))*domBottom" y2="550" stroke="#dddddd" style="stroke-width: 2px;"></line> -->
                </svg>

        		<div id="dates" ms-each-param="params">
                    <div class="time" ms-attr-style="'left:'+($index*200+50)+'px;'">{{param.timeText}}</div>
        		    <div class="time fromLast" ms-attr-style="'left:'+($index*200-50)+'px;'" ms-if='param.fromLast'>{{param.fromLast}}</div>
        		</div>


                <div id="params" ms-each-param="params" data-each-rendered="paramRendered">
                    <div ms-attr-id="'param'+($index+1)" ms-data-param="param" class="param" ms-mouseenter="active" ms-mouseleave="unactive" ms-click='gotoDetailParam'>
                        <div class="cover" ms-class="show:param.cover" ><img ms-src="param.cover"/></div>
                        <div class="title">{{param.title}}</div>
                        <div class="text">{{param.content}}</div>
                        <div class="more">!</div>
                    </div>
                </div>
        	</div>
        </div>

    </div>

    <script src="./lib/avalon.js"></script>
    <script>
    avalon.require(['../app/main'],function(app){
        app.run()
    })
    </script>
</body>
</html>